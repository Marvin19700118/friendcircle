import{r,j as e,S as C}from"./index-FOHbnj39.js";import{g as S}from"./geminiService-BIhn4d3U.js";import{s as T}from"./dataService-CBqyM4Ad.js";const $=({user:o,onLogout:A,onNavigateHome:j,onNavigate:N})=>{const[b,w]=r.useState([]);r.useEffect(()=>{if(o.uid){const t=T(o.uid,l=>{w(l)});return()=>t()}},[o.uid]);const[c,x]=r.useState([{role:"model",text:"Hello! 我是您的社交助理。您可以問我任何關於聯絡人的問題。",time:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}]),[v,y]=r.useState(["誰最近生日？","顯示最近互動","有哪些 VIP 客戶？"]),[n,f]=r.useState(""),[i,g]=r.useState(!1),d=r.useRef(null);r.useEffect(()=>{d.current&&(d.current.scrollTop=d.current.scrollHeight)},[c,i]);const m=()=>new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),u=async t=>{const l=t||n;if(!l.trim()||i)return;const a={role:"user",text:l,time:m()};x(s=>[...s,a]),f(""),g(!0);try{const s=await S(c,l,b),p=s.relevantContactIds?b.filter(h=>s.relevantContactIds.includes(h.id)):[],k={role:"model",text:s.answer,time:m(),contacts:p};x(h=>[...h,k]),s.suggestedQuestions&&s.suggestedQuestions.length>0&&y(s.suggestedQuestions)}catch(s){console.error("ChatScreen Error:",s),x(p=>[...p,{role:"model",text:`抱歉，發生錯誤：${s.message||"請稍後再試。"}`,time:m()}])}finally{g(!1)}};return e.jsxs("div",{className:"flex flex-col h-full bg-[#f8fafc] dark:bg-slate-950",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-4 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md sticky top-0 z-50 border-b border-slate-100 dark:border-slate-800",children:[e.jsx("button",{onClick:j,className:"text-slate-800 dark:text-white",children:e.jsx("span",{className:"material-symbols-outlined text-[24px]",children:"chevron_left"})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h1",{className:"text-base font-bold text-slate-900 dark:text-white",children:"Networking Assistant"}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-[10px] text-slate-500 font-medium",children:"Online"})]})]}),e.jsx("button",{className:"text-slate-800 dark:text-white",children:e.jsx("span",{className:"material-symbols-outlined",children:"more_horiz"})})]}),e.jsxs("div",{ref:d,className:"flex-1 overflow-y-auto px-4 pb-44 no-scrollbar",children:[e.jsx("div",{className:"flex justify-center my-6",children:e.jsx("span",{className:"text-[11px] font-bold text-slate-300 dark:text-slate-600 uppercase tracking-widest bg-slate-100 dark:bg-slate-800 px-3 py-1 rounded-lg",children:"Today"})}),e.jsxs("div",{className:"flex flex-col gap-6",children:[c.map((t,l)=>e.jsxs("div",{className:`flex flex - col ${t.role==="user"?"items-end":"items-start"} `,children:[e.jsxs("div",{className:`flex items - end gap - 2.5 max - w - [90 %] ${t.role==="user"?"flex-row-reverse":"flex-row"} `,children:[t.role==="model"&&e.jsx("div",{className:"w-9 h-9 rounded-full overflow-hidden shrink-0 border border-slate-100",children:e.jsx("img",{src:"https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=100&h=100&fit=crop",alt:"AI"})}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("div",{className:`px - 4 py - 3 rounded - [20px] text - [15px] leading - relaxed shadow - sm ${t.role==="user"?"bg-primary text-white rounded-br-none":"bg-white dark:bg-slate-800 text-slate-800 dark:text-slate-200 border border-slate-50 dark:border-slate-700 rounded-bl-none"} `,children:t.text}),t.role==="user"&&e.jsxs("span",{className:"text-[10px] text-slate-400 font-medium pr-1",children:["Read ",t.time]})]})]}),t.contacts&&t.contacts.length>0&&e.jsxs("div",{className:"w-full max-w-[90%] mt-3 flex flex-col gap-2 ml-11",children:[t.contacts.map(a=>e.jsxs("div",{onClick:()=>N(C.CONTACT_DETAIL,a),className:"bg-white dark:bg-slate-800 rounded-2xl p-3 flex items-center justify-between border border-slate-50 dark:border-slate-700 shadow-sm hover:border-primary/30 transition-all cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:a.avatar,className:"w-11 h-11 rounded-full object-cover",alt:a.name}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900 dark:text-white text-sm",children:a.name}),e.jsx("p",{className:"text-slate-400 text-[11px] mt-0.5",children:a.role}),a.tags&&a.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:a.tags.map(s=>e.jsx("span",{className:"px-1.5 py-0.5 bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400 rounded-md text-[8px] font-bold border border-slate-50 dark:border-slate-600",children:s},s))})]})]}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-50 dark:bg-slate-700 flex items-center justify-center text-slate-300",children:e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"chevron_right"})})]},a.id)),e.jsxs("button",{className:"flex items-center justify-end gap-1 text-primary text-[13px] font-bold mt-2 pr-2 hover:underline",children:["Explore all ",t.contacts.length," profiles ",e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"arrow_right_alt"})]})]})]},l)),i&&e.jsxs("div",{className:"flex items-end gap-2.5",children:[e.jsx("div",{className:"w-9 h-9 rounded-full overflow-hidden shrink-0 border border-slate-100",children:e.jsx("img",{src:"https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=100&h=100&fit=crop",alt:"AI"})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl px-4 py-3 shadow-sm border border-slate-50 dark:border-slate-700 rounded-bl-none",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-primary/40 rounded-full animate-bounce"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-primary/40 rounded-full animate-bounce [animation-delay:0.2s]"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-primary/40 rounded-full animate-bounce [animation-delay:0.4s]"})]})})]})]})]}),e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 max-w-[480px] mx-auto bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl border-t border-slate-100 dark:border-slate-800 z-50",children:[e.jsx("div",{className:"flex gap-2 px-4 py-3 overflow-x-auto no-scrollbar",children:v.map((t,l)=>e.jsx("button",{onClick:()=>u(t),className:"flex-none px-4 py-2 bg-blue-50 dark:bg-blue-900/30 text-primary text-[13px] font-bold rounded-xl hover:bg-primary hover:text-white transition-all whitespace-nowrap border border-blue-100 dark:border-blue-800",children:t},l))}),e.jsxs("div",{className:"flex items-center gap-3 px-4 pb-6 pt-1",children:[e.jsx("button",{className:"w-11 h-11 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-slate-400 hover:text-primary transition-colors shrink-0",children:e.jsx("span",{className:"material-symbols-outlined text-[24px]",children:"add"})}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",placeholder:"Ask about your network..",className:"w-full h-11 bg-slate-100 dark:bg-slate-800 border-none rounded-full px-5 pr-11 text-sm text-slate-800 dark:text-white placeholder:text-slate-400 focus:ring-2 focus:ring-primary/20 transition-all",value:n,onChange:t=>f(t.target.value),onKeyDown:t=>t.key==="Enter"&&u()}),e.jsx("button",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400",children:e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"mic"})})]}),e.jsx("button",{onClick:()=>u(),disabled:!n.trim()||i,className:`w - 11 h - 11 rounded - full flex items - center justify - center transition - all shrink - 0 ${n.trim()?"bg-primary text-white shadow-lg shadow-primary/30 active:scale-95":"bg-slate-100 dark:bg-slate-800 text-slate-300"} `,children:e.jsx("span",{className:"material-symbols-outlined text-[22px]",children:"send"})})]}),e.jsxs("div",{className:"flex items-center justify-center gap-1.5 pb-4 opacity-30",children:[e.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"lock"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:"Personal Context Encrypted"})]})]})]})};export{$ as default};
